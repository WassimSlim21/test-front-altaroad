import{a as z,b as H,c as U,d as B,e as N,f as F,g as L,h as Q,i as K,j as q,k as G,l as T,m as V,n as J,o as X,p as Z,q as tt,r as et,s as it,t as nt,u as ot,v as at}from"./chunk-RH2TO5AR.js";import{a as rt}from"./chunk-JBDO4HMM.js";import{f as A,i as P,j as M,k as W,m as Y}from"./chunk-QEX3WDPP.js";import"./chunk-AESYL7IM.js";import{$ as v,Ab as D,Bb as h,Cb as g,Eb as S,Hb as p,Jb as C,Jc as j,Lc as O,Ob as I,Pb as R,Qb as $,Sa as E,Ua as u,Ub as s,Va as w,Vb as y,ia as k,ja as b,nb as f,pb as x,qa as m,ra as d,yb as r,zb as c}from"./chunk-VVGJ5PLE.js";function mt(t,a){if(t&1){let e=S();r(0,"th",24),p("click",function(i){m(e);let o=C();return d(o.sortData(i,"name"))}),s(1," Name "),c()}}function dt(t,a){if(t&1&&(r(0,"td",25),s(1),c()),t&2){let e=a.$implicit;u(),y(e.name)}}function ut(t,a){if(t&1){let e=S();r(0,"th",24),p("click",function(i){m(e);let o=C();return d(o.sortData(i,"population"))}),s(1," Population "),c()}}function pt(t,a){if(t&1&&(r(0,"td",25),s(1),c()),t&2){let e=a.$implicit;u(),y(e.population)}}function Ct(t,a){if(t&1){let e=S();r(0,"th",24),p("click",function(i){m(e);let o=C();return d(o.sortData(i,"area"))}),s(1," Area "),c()}}function _t(t,a){if(t&1&&(r(0,"td",25),s(1),c()),t&2){let e=a.$implicit;u(),y(e.area)}}function ft(t,a){if(t&1){let e=S();r(0,"th",24),p("click",function(i){m(e);let o=C();return d(o.sortData(i,"continent"))}),s(1," Continent "),c()}}function ht(t,a){if(t&1&&(r(0,"td",25),s(1),c()),t&2){let e=a.$implicit;u(),y(e.continent)}}function gt(t,a){if(t&1){let e=S();r(0,"th",24),p("click",function(i){m(e);let o=C();return d(o.sortData(i,"gdp"))}),s(1," GDP "),c()}}function St(t,a){if(t&1&&(r(0,"td",25),s(1),c()),t&2){let e=a.$implicit;u(),y(e.gdp)}}function xt(t,a){t&1&&(r(0,"th",26),s(1,"Image"),c())}function wt(t,a){if(t&1&&(h(0),r(1,"div",28),D(2,"img",29),c(),g()),t&2){let e=C().$implicit,n=C();u(2),x("src",n.getSafeImageUrl(e.image),E)}}function yt(t,a){t&1&&(h(0),s(1," No Image Available "),g())}function vt(t,a){if(t&1&&(r(0,"td",25),f(1,wt,3,1,"ng-container",27)(2,yt,2,0,"ng-container",27),c()),t&2){let e=a.$implicit;u(),x("ngIf",e.image),u(),x("ngIf",!e.image)}}function bt(t,a){t&1&&(r(0,"th",26),s(1,"Actions"),c())}function Vt(t,a){if(t&1){let e=S();r(0,"td",25)(1,"button",30),p("click",function(){let i=m(e).$implicit,o=C();return d(o.editCountry(i))}),r(2,"mat-icon"),s(3,"edit"),c()(),r(4,"button",31),p("click",function(){let i=m(e).$implicit,o=C();return d(o.deleteCountry(i))}),r(5,"mat-icon"),s(6,"delete"),c()()()}}function Dt(t,a){t&1&&D(0,"tr",32)}function Mt(t,a){if(t&1){let e=S();r(0,"tr",33),p("click",function(i){let o=m(e).$implicit,l=C();return d(l.viewDetails(o,i))}),c()}}var st=(()=>{class t{countryService;dialog;sanitizer;router;snackBar;displayedColumns=["name","population","area","continent","image","gdp","actions"];displayedColumnswithoutEdit=["name","population","area","continent","image","gdp"];jsonUrl="assets/data/countries.json";localStorageKey="countries";dataSource=new T;countries=[];searchInput="";sort;constructor(e,n,i,o,l){this.countryService=e,this.dialog=n,this.sanitizer=i,this.router=o,this.snackBar=l}ngAfterViewInit(){this.sort?this.dataSource.sort=this.sort:console.warn("MatSort instance not found.")}ngOnInit(){this.loadCountries()}getSafeImageUrl(e){let n=`${W.apiUrl}/uploads/${e}`;return this.sanitizer.bypassSecurityTrustUrl(n)}loadCountries(){this.countries=this.countryService.getCountries(),this.dataSource=new T(this.countries)}sortData(e,n){let i=n;if(this.dataSource.sort){let l=this.sort.active,_=this.sort.direction;l===i?this.sort.direction=_==="asc"?"desc":"asc":(this.dataSource.sort.active=i,this.dataSource.sort.direction="asc"),this.dataSource.sort.sortChange.emit({active:this.dataSource.sort.active,direction:this.dataSource.sort.direction})}else console.warn("MatSort not available or initialized.");let o=this.getSortDirection(i);console.log(`Sorting ${i} in ${o} order.`)}getSortDirection(e){return this.dataSource.sort&&this.dataSource.sort.active===e?this.dataSource.sort.direction:"asc"}applyFilter(e){this.dataSource.filter=e.trim().toLowerCase()}exportToCSV(){let e=this.countries.map(_=>({name:_.name,population:_.population,area:_.area,continent:_.continent,gdp:_.gdp,image:_.image})),n=this.convertToCSV(e),i=new Blob([n],{type:"text/csv"}),o=window.URL.createObjectURL(i),l=document.createElement("a");l.setAttribute("href",o),l.setAttribute("download","countries.csv"),l.click()}convertToCSV(e){return[Object.keys(e[0])].concat(e).map(i=>Object.values(i).toString()).join(`
`)}viewDetails(e,n){let i=n.target;i.classList.contains("mat-icon")&&i.textContent==="edit"||this.router.navigate(["/country-details",e.name])}deleteAll(){localStorage.removeItem(this.localStorageKey),this.countries=[],this.dataSource.data=this.countries,localStorage.setItem(this.localStorageKey,this.countries.toString())}uploadAll(){this.countryService.loadCountriesFromJson().subscribe(()=>{this.loadCountries(),this.dataSource.data=this.countries})}addCountry(){this.dialog.open(tt,{data:{country:{}}}).afterClosed().subscribe(n=>{n&&(this.countries.push(n),this.snackBar.open("Country "+n.name+" Added successfully!!","Close",{duration:3e3}),this.countryService.saveCountries(),this.loadCountries())})}editCountry(e){this.dialog.open(et,{data:{country:e},width:"600px",height:"auto"}).afterClosed().subscribe(i=>{if(i){let o=this.countries.findIndex(l=>l.name===e.name);this.countries[o]=i,this.snackBar.open("Country "+i.name+" Updated successfully!!","Close",{duration:3e3}),this.countryService.saveCountries(),this.loadCountries()}})}deleteCountry(e){let n=this.countries.indexOf(e);n>=0&&(this.countries.splice(n,1),this.dataSource.data=this.countries,this.countryService.saveCountries(),this.snackBar.open(`Country ${e.name} deleted successfully!`,"Close",{duration:3e3}))}static \u0275fac=function(n){return new(n||t)(w(Y),w(X),w(A),w(P),w(it))};static \u0275cmp=k({type:t,selectors:[["app-countries"]],viewQuery:function(n,i){if(n&1&&I(V,5),n&2){let o;R(o=$())&&(i.sort=o.first)}},decls:39,vars:3,consts:[["sort","matSort"],[1,"countries-container"],[1,"container-fluid"],[3,"exportCSV","searchInputChange","addCountry"],[1,"body-container"],[1,"table-container"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",3,"click",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","population"],["matColumnDef","area"],["matColumnDef","continent"],["matColumnDef","gdp"],["matColumnDef","image"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],[1,"container-fluid","mt-5","pb-5"],[1,"row","text-center"],[1,"col-6"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-warning",3,"click"],["mat-header-cell","","mat-sort-header","",3,"click"],["mat-cell",""],["mat-header-cell",""],[4,"ngIf"],[1,"image-container"],["alt","Country Image",1,"zoomable-image",3,"src"],["mat-icon-button","","id","edit",3,"click"],["mat-icon-button","","id","delete",3,"click"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(n,i){if(n&1){let o=S();r(0,"div",1)(1,"div",2)(2,"app-header",3),p("exportCSV",function(){return m(o),d(i.exportToCSV())})("searchInputChange",function(_){return m(o),d(i.applyFilter(_))})("addCountry",function(){return m(o),d(i.addCountry())}),c()()(),r(3,"div",2)(4,"div",4)(5,"div",5)(6,"table",6,0),h(8,7),f(9,mt,2,0,"th",8)(10,dt,2,1,"td",9),g(),h(11,10),f(12,ut,2,0,"th",8)(13,pt,2,1,"td",9),g(),h(14,11),f(15,Ct,2,0,"th",8)(16,_t,2,1,"td",9),g(),h(17,12),f(18,ft,2,0,"th",8)(19,ht,2,1,"td",9),g(),h(20,13),f(21,gt,2,0,"th",8)(22,St,2,1,"td",9),g(),h(23,14),f(24,xt,2,0,"th",15)(25,vt,3,2,"td",9),g(),h(26,16),f(27,bt,2,0,"th",15)(28,Vt,7,0,"td",9),g(),f(29,Dt,1,0,"tr",17)(30,Mt,1,0,"tr",18),c()()()(),r(31,"div",19)(32,"div",20)(33,"div",21)(34,"button",22),p("click",function(){return m(o),d(i.uploadAll())}),s(35," Reload all the data "),c()(),r(36,"div",21)(37,"button",23),p("click",function(){return m(o),d(i.deleteAll())}),s(38," Delete all the Data "),c()()()()}n&2&&(u(6),x("dataSource",i.dataSource),u(23),x("matHeaderRowDef",i.displayedColumns),u(),x("matRowDefColumns",i.displayedColumns))},dependencies:[j,nt,Z,ot,H,B,Q,N,U,K,F,L,q,G,V,J],styles:[".zoomable-image[_ngcontent-%COMP%]{max-width:100%;max-height:200px;width:auto;height:auto;transition:transform .3s ease}.zoomable-image[_ngcontent-%COMP%]:hover{transform:scale(1.2)}.table-container[_ngcontent-%COMP%]{overflow-x:auto}table[_ngcontent-%COMP%]{width:100%;table-layout:fixed}.body-container[_ngcontent-%COMP%]{margin-top:1px;box-sizing:border-box;border:4px solid green;padding:10px}.mat-header-cell[_ngcontent-%COMP%]{padding:10px;font-weight:700}.mat-cell[_ngcontent-%COMP%]{padding:10px}.mat-sort-header[_ngcontent-%COMP%]{cursor:pointer;font-weight:700}  .modal-header{padding:1rem;background-color:#f0f0f0}  .modal-body{padding:1rem}"]})}return t})();var Tt=[{path:"",component:st},{path:"country-details/:name",component:rt},{path:"",redirectTo:"countries",pathMatch:"full"},{path:"**",redirectTo:"countries"}],lt=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=b({type:t});static \u0275inj=v({imports:[M.forChild(Tt),M]})}return t})();var ie=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=b({type:t});static \u0275inj=v({imports:[z,O,at,lt]})}return t})();export{ie as CountriesModule};
